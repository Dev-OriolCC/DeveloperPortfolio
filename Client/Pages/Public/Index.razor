@page "/"
@* Import database *@
@using Client.Services
@using Client.Components.Public.Blog

<div class="site-wrap">
    <div class="site-mobile-menu">
        <div class="site-mobile-menu-header">
            <div class="site-mobile-menu-close mt-3">
                <span class="icon-close2 js-menu-toggle"></span>
            </div>
        </div>
        <div class="site-mobile-menu-body"></div>
    </div>

@* Navigation Bar *@
<Client.Components.Public.Shared.Navbar />
</div>

    
<main class="d-flex flex-column w-100 min-vh-90 justify-content-center align-items-center overflow-auto bg-motherboard-dev">
    
    <div class="container g-0">
        <div class="row g-8">
            <div class="col-lg-6"></div>
            <div class="col-lg-6 d-inline-flex flex-column bg-white-94 p-5 shadow-no-hover">
                <h1 class="d-inline-flex">Welcome to Blog</h1>
                <p class="d-inline-flex">
                    Posts about Technology and more.
                    <br />
                    <br />
                    Stand out with the latest information.
                </p>
                @* Links *@
                <a href="/portfolio" class="btn btn-primary shadow btn-lg fw-bold mt-3 md-f-size-1-5">
                    <i class="fas fa-project-diagram"></i> Projects
                </a>
                <a href="/portfolio" class="btn btn-secondary shadow btn-lg fw-bold mt-3 md-f-size-1-5">
                    <i class="fas fa-info"></i> More Information
                </a>
            </div>
        </div>
    </div>
    
</main>
@* Categories Section *@
@* Needs to be converted to a component *@
<div class="site-section">
    <div class="container">
        <div class="row">
            <!-- Display Categories -->
            @if(InMemoryDatabaseCache.categories.Count != 0)
            {
                @foreach (var category in InMemoryDatabaseCache.categories)
               {
                    <CategoryCard Category="category" />
               }
            }
        </div>
    </div>
</div>

<Client.Components.Public.Shared.Footer />

@* Fetch from categories from db *@
@implements IDisposable
@code
{
    [Inject] InMemoryDatabaseCache InMemoryDatabaseCache { get; set;}
    protected override async Task OnInitializedAsync()
    {
        InMemoryDatabaseCache.OnCategoriesDataChanged += StateHasChanged;
        if (InMemoryDatabaseCache.categories == null)
        {
            await InMemoryDatabaseCache.GetCategoriesFromDatabaseAndCache();        
        }
        // Avoid memory link
    }
    public void Dispose()
    {
        InMemoryDatabaseCache.OnCategoriesDataChanged -= StateHasChanged;
    }
}